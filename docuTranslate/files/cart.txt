import 'package:flutter/material.dart';
import 'package:flutterappppp/products.dart';
import 'package:http/http.dart' as http;

class Dashboard extends StatefulWidget {
  @override
  _DashboardState createState() => _DashboardState();
}

class _DashboardState extends State<Dashboard> {


  final TextEditingController codeController = TextEditingController();

  Future<List<Products>> displayProduct(String code) async{
    final String apiUrl = " http://164.52.197.189:8181/fdb/prudle/db001/query";
    final response = await http.post(apiUrl, body: {"select": {"?group":
    ["barcodeValue","productName","productVariant","productImage","productPrice"]},
      "where": [["?group", "productDetails/barcodeValue", code]]});

    if(response.statusCode == 201){
      final String responseString = response.body;
      return productsFromJson(responseString);
    }
    else{
      return null;
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: SingleChildScrollView(
        child: SafeArea(
          child: Column(
            children: <Widget>[
              Padding(
                padding: const EdgeInsets.all(40.0),
                child: TextField(
                  controller: codeController,
                  decoration: InputDecoration(
                    hintText: 'Enter the code'
                  ),
                ),
              ),
              ListTile(
                title: Card(
                  child: Container(
                    height: 100,
                    width: 100,
                    decoration: BoxDecoration(
                      image: DecorationImage(image: NetworkImage(productDetailsProductImage))
                    ),
                  ),
                ),
              ),
            ],
          ),
          ),
      ),
      floatingActionButton: FloatingActionButton(onPressed: () async {
        final String code = codeController.text;
        final List<Products> products = await displayProduct(code);

      }),
      );
  }
}
